<!DOCTYPE html>
<html>

<head>

    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

    <link href="fonts/zilla-slab.css" rel="stylesheet">

    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/sidebar.css" />
    <link rel="stylesheet" href="css/save-modal.css" />
    <link rel="stylesheet" href="css/export-modal.css" />
    <link rel="stylesheet" href="css/timeline.css" />
    <link rel="stylesheet" href="css/viewport.css" />
    <link rel="stylesheet" href="css/icons.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">

    <!-- Primary Meta Tags -->
    <title>TorquiGen ‚Äî Animated kaleidoscope for your images</title>
    <meta name="title" content="TorquiGen ‚Äî Animated kaleidoscope for your images">
    <meta name="description" content="Create seamlessly looping animations of your own images, free, open-source">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://torquigen.app/">
    <meta property="og:title" content="TorquiGen ‚Äî Animated kaleidoscope for your images">
    <meta property="og:description"
        content="Create seamlessly looping animations of your own images, free, open-source">
    <meta property="og:image" content="https://torquigen.app/bluetorq.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://torquigen.app/">
    <meta property="twitter:title" content="TorquiGen ‚Äî Animated kaleidoscope for your images">
    <meta property="twitter:description"
        content="Create seamlessly looping animations of your own images, free, open-source">
    <meta property="twitter:image" content="https://torquigen.app/bluetorq.png">
</head>

<body>
    <div id="sidebar" style="width: 17.6rem;">
        <h1 class="header">TorquiGen</h1>
        <img src="1f300.svg" alt="Cyclone" class="accent">
        <div class="controls">
            <span style="width: 19rem; text-align: right;">Click to Upload or Drop Image:</span>
            <div id="drop-zone"><img id="input-image" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="
                    alt="Input Image" /></div>
            <button id="save-load-open" style="margin:1rem 0;">Save and Load Settings</button>
            <details>
                <summary>About</summary>
                <p>
                    TorquiGen is a free, open-source tool for creating animated kaleidoscopes from your own images.
                    <br><br>
                    The <em>Controls</em> to the right allow you to change the many parameters that create the resulting image.
                    <br><br>
                    The timeline and automation tracks below the main viewport are used to overwrite <em>Controls</em> using smooth curves between values.
                    <br><br>
                    The <em>Save and Load Settings</em> button allows you to save your current settings to a file, and load them back in later.  These saves do not include input images.
                </p>
            </details>
            <a href="https://github.com/figrita/torquigen" style="text-decoration: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github"
                    viewBox="0 0 16 16">
                    <path
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z">
                    </path>
                </svg>
                Github
            </a>
            <a href="https://discord.gg/cZYa2bDjs9" style="text-decoration: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-discord"
                    viewBox="0 0 16 16">
                    <path
                        d="M13.545 2.907a13.227 13.227 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.19 12.19 0 0 0-3.658 0 8.258 8.258 0 0 0-.412-.833.051.051 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019c.308-.42.582-.863.818-1.329a.05.05 0 0 0-.01-.059.051.051 0 0 0-.018-.011 8.875 8.875 0 0 1-1.248-.595.05.05 0 0 1-.02-.066.051.051 0 0 1 .015-.019c.084-.063.168-.129.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.052.052 0 0 1 .053.007c.08.066.164.132.248.195a.051.051 0 0 1-.004.085 8.254 8.254 0 0 1-1.249.594.05.05 0 0 0-.03.03.052.052 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.235 13.235 0 0 0 4.001-2.02.049.049 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034 0 0 0-.02-.019Zm-8.198 7.307c-.789 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612Zm5.316 0c-.788 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612Z" />
                </svg>
                Discord
            </a>
        </div>
        <div id="hideshow"><i class="gg-chevron-left"></i></div>
        <div id="resize-sidebar">‚¨å</div>
    </div>

    <div class="workspace">
        <div id="viewport" style="height: calc(100vh - 20rem);">
            <canvas id="webgl-canvas" width="512" height="512"></canvas>
            <div class="viewport-controls">
                <span class="left-options">
                    <label for="viewport-zoom-slider">üîç Zoom</label>
                    <input type="range" min="0.1" max="10" value="1" step="0.1" class="viewport-zoom-slider"
                        id="viewport-zoom-slider"><span style="width: 3rem">1.0</span>
                    <button class="viewport-zoom-reset">Ôºë</button>
                    <button class="viewport-position-reset"><i class="gg-assign"></i></button>
                    <select id="image-rendering">
                        <option value="pixelated">Pixelated</option>
                        <option value="auto">Auto</option>
                    </select>
                    <div id="hideshowtimeline"><i class="gg-chevron-down"></i></div>
                </span>
                <div id="resize-viewport">‚¨ç</div>
            </div>
        </div>
        <div class="timeline">
            <div class="transport" id="transport">
                <div class="transport-options">
                    <span>
                        <label for="loop-length">‚è≤Ô∏è&#xFE0E; Length: </label>
                        <select class="loop-length" id="loop-length">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5" selected>5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="30">30</option>
                            <option value="45">45</option>
                            <option value="50">50</option>
                            <option value="60">60</option>
                            <option value="90">90</option>
                            <option value="120">120</option>
                            <option value="150">150</option>
                            <option value="180">180</option>
                            <option value="270">270</option>
                            <option value="360">360</option>
                        </select>
                        (seconds)
                    </span>
                    <div class="transport-controls">
                        <button class="btn" id="transport_begin"><i class="gg-play-track-prev-r"></i></button>
                        <button class="btn" id="transport_play"><i class="gg-play-button-r"></i></button>
                        <button class="btn" id="transport_stop"><i class="gg-play-stop-r"></i></button>
                        <button class="btn" id="transport_pause"><i class="gg-play-pause-r"></i></button>
                        <button class="btn" id="transport_end"><i class="gg-play-track-next-r"></i></button>
                    </div>
                    <span>
                        <button id="export-animation" class="submit">üé¨&#xFE0E;&nbsp;Export</button>
                    </span>
                </div>
                <div class="transport-timeline">
                    <input type="range" min="0" max="1" value="0" step=".001" class="timeline-slider"
                        id="timeline-slider">
                </div>
            </div>
            <div id="animation-tracks"></div>
        </div>
    </div>
    <div id="export-modal">
        <div class="export-content">
            <form id="export-form">
                <label for="frame-rate">üìΩ&#xFE0E;&nbsp;FPS</label>
                <select class="frame-rate" id="frame-rate">
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="25">25</option>
                    <option value="30" selected>30</option>
                    <option value="60">60</option>
                </select>
                <label for="export-format">üì¶&#xFE0E;&nbsp;Format</label>
                <select id="export-format">
                    <option value="gif" selected>GIF</option>
                    <option value="webm">Webm</option>
                    <option value="png">PNG</option>
                </select>
                <input type="submit" id="export-submit" class="submit" value="üé¨&#xFE0E;&nbsp;Export">
                <button id="cancel-export" class="cancel">Cancel</button>
            </form>
            <div id="export-progress" style="display:none">
                <div class="progress-container" id="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <span class="progress-text" id="progress-text">Rendering...</span>
                <button id="cancel-render" class="cancel">Cancel</button>
            </div>
        </div>
    </div>
    <div id="save-modal" style="display: none;">
        <div id="save-content">
            <label for="textarea-save">Save or Load as Text</label>
            <textarea id="textarea-save"></textarea>
            <span><button id="btn-save">Save</button><button id="btn-load">Load</button></span>
            <div style="display: block; width: 100%; height: 1px; margin: 1rem 0; border-bottom: 1px dashed #fff;">
            </div>
            <label for="input-save-as">Save as File</label>
            <span><input type="text" id="input-save-as" value="Untitled">.torq<button id="btn-save-as">Save
                    As</button></span>
            <br>
            <label for="input-file-load">Load from File</label>
            <span><input type="file" id="input-file-load" accept=".json, .torq"><button
                    id="btn-file-load">Load</button></span>

            <br>
            <button id="btn-close" style="margin: 0 auto">Close</button>
        </div>
    </div>
    <script src="js/ccapture/CCapture.js"></script>
    <script src="js/ccapture/gif.js"></script>
    <script src="js/ccapture/download.js"></script>
    <script src="js/ccapture/tar.js"></script>
    <script src="js/ccapture/webm-writer-0.3.0.js"></script>
    <script src="js/panzoom/panzoom.js"></script>
    <script type="module" src="js/main.js"></script>
    <script type="module">
        const checkBrowserAndRemoveOption = () => {
            const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

            if (isSafari) {
                const selectElement = document.querySelector('#export-format');
                Array.from(selectElement?.options || [])
                    .filter(option => option.value === "webm")
                    .forEach(option => option.remove());
            }
        }

        const resetValues = () => {
            // Reset all input fields
            Array.from(document.querySelectorAll('input:not(.lil-gui input)'))
                .filter(input => input.type != 'button')
                .forEach(input => input.value = input.defaultValue);

            // Reset all textarea fields
            Array.from(document.querySelectorAll('textarea:not(.lil-gui textarea)'))
                .forEach(textarea => textarea.value = textarea.defaultValue);

            // Reset all select dropdowns
            Array.from(document.querySelectorAll('select:not(.lil-gui select)'))
                .forEach(select => {
                    const selectedOption = Array.from(select.options).find(option => option.defaultSelected);
                    if (selectedOption) {
                        select.value = selectedOption.value;
                    } else if (select.options.length > 0) {
                        // Select the first option if no option has the "selected" attribute
                        select.options[0].selected = true;
                    }
                });

            // Continue with existing onload functions if any
            checkBrowserAndRemoveOption();
        };

        window.onload = resetValues;

    </script>
</body>

</html>